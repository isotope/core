;var Isotope={toggleCheckboxGroup:function(e,t){var n=document.id(e).className;var r=document.id(e).checked?"checked":"";if(n=="tl_checkbox"){$$("#"+t+" .tl_checkbox").each(function(e){if(!e.disabled)e.checked=r})}else if(n=="tl_tree_checkbox"){$$("#"+t+" .parent .tl_tree_checkbox").each(function(e){if(!e.disabled)e.checked=r})}Backend.getScrollOffset()},openModalGroupSelector:function(e){var t=e||{};var n=(window.getSize().y-180).toInt();if(!t.height||t.height>n)t.height=n;var r=new SimpleModal({width:t.width,btn_ok:Contao.lang.close,draggable:false,overlayOpacity:.5,onShow:function(){document.body.setStyle("overflow","hidden")},onHide:function(){document.body.setStyle("overflow","auto")}});r.addButton(Contao.lang.close,"btn",function(){this.hide()});r.addButton(Contao.lang.apply,"btn primary",function(){var e=[],n=null,r=window.frames;for(var i=0;i<r.length;i++){if(r[i].name=="simple-modal-iframe"){n=r[i];break}}if(n===null){alert("Could not find the SimpleModal frame");return}var s=n.document.getElementById("tl_listing").getElementsByTagName("input");for(var i=0;i<s.length;i++){if(!s[i].checked||s[i].id.match(/^check_all_/))continue;if(!s[i].id.match(/^reset_/))e.push(s[i].get("value"))}(new Request.Contao({evalScripts:false,onRequest:AjaxRequest.displayBox(Contao.lang.loading+" …"),onSuccess:function(e,t){if(e!=""){window.location.href=e}}})).post({action:t.action,value:e[0],redirect:t.redirect,REQUEST_TOKEN:Contao.request_token});this.hide();if(t.trigger){t.trigger.fireEvent("closeModal")}});r.show({title:t.title,contents:'<iframe src="'+t.url+'" name="simple-modal-iframe" width="100%" height="'+t.height+'" frameborder="0"></iframe>',model:"modal"});return r},openModalPageSelector:function(e){var t=e||{};var n=(window.getSize().y-180).toInt();if(!t.height||t.height>n)t.height=n;var r=new SimpleModal({width:t.width,btn_ok:Contao.lang.close,draggable:false,overlayOpacity:.5,onShow:function(){document.body.setStyle("overflow","hidden")},onHide:function(){document.body.setStyle("overflow","auto")}});r.addButton(Contao.lang.close,"btn",function(){this.hide()});r.addButton(Contao.lang.apply,"btn primary",function(){var e=0,n=null,r=window.frames;for(var i=0;i<r.length;i++){if(r[i].name=="simple-modal-iframe"){n=r[i];break}}if(n===null){alert("Could not find the SimpleModal frame");return}var s=n.document.getElementById("tl_listing").getElementsByTagName("input");for(var i=0;i<s.length;i++){if(!s[i].checked||s[i].id.match(/^check_all_/))continue;if(!s[i].id.match(/^reset_/))e=s[i].get("value")}(new Request.Contao({evalScripts:false,onRequest:AjaxRequest.displayBox(Contao.lang.loading+" …"),onSuccess:function(e,t){if(e!=""){window.location.href=e}}})).post({action:t.action,value:e,redirect:t.redirect,REQUEST_TOKEN:Contao.request_token});this.hide()});r.show({title:t.title,contents:'<iframe src="'+t.url+'" name="simple-modal-iframe" width="100%" height="'+t.height+'" frameborder="0"></iframe>',model:"modal"});return r},addInteractiveHelp:function(){new Tips.Contao("a.tl_tip",{offset:{x:9,y:21},text:function(e){return e.get("longdesc")}})},inheritFields:function(e,t){var n=false;e.each(function(e,r){var i=document.id("ctrl_"+e);if(i){var s=i.getParent("div").getFirst("h3");if(!s&&i.match(".tl_checkbox_single_container")){s=i}if(!s){n=true;return}s.addClass("inherit");var o=document.id("ctrl_inherit").getFirst("input[value="+e+"]");o.setStyle("float","right").inject(s);document.id("ctrl_inherit").getFirst("label[for="+o.get("id")+"]").setStyles({"float":"right","padding-right":"5px","font-weight":"normal"}).set("text",t).inject(s);o.addEvent("change",function(e){var t=document.id("ctrl_"+e.target.get("value"));if(t.match(".tl_checkbox_single_container")){t.getFirst("input[type=checkbox]").disabled=e.target.checked}else{if(!t.getNext()||!t.getNext().get("id")||!t.getNext().get("id").test(/_parent$/)){t.setStyle("display",e.target.checked?"none":"inherit")}try{t.getNext(":not(.tl_tip):not(script)").setStyle("display",e.target.checked?"none":"inherit")}catch(n){}}});if(i.match(".tl_checkbox_single_container")){i.getFirst("input[type=checkbox]").disabled=o.checked}else{i.setStyle("display",o.checked?"none":"inherit");try{i.getNext(":not(.tl_tip):not(script)").setStyle("display",o.checked?"none":"inherit")}catch(u){}}}});if(!n){document.id("ctrl_inherit").getParent("div").setStyle("display","none")}},makeSelectExtendable:function(){var e={};document.getElements("select.extendable").forEach(function(t){var n=t.value;var r=t.getParent("table").id;e[r]=e[r]||[];e[r].push(t);t.grab(new Element("option",{text:"Add …",value:"extendSelect"})).addEvent("change",function(i){if(t.value=="extendSelect"){var s=prompt("Please enter the new group name.");if(s!=""){if(r&&e[r]){e[r].forEach(function(e){(new Element("option",{text:s,value:s})).inject(e.getLast(),"before")})}else{(new Element("option",{text:s,value:s})).inject(t.getLast(),"before")}t.value=s;n=s}else{t.value=n}t.fireEvent("change")}else{n=t.value}})})},makePageViewSortable:function(e){var t=new Sortables(e,{contstrain:true,opacity:.6});t.active=false;t.addEvent("start",function(){t.active=true});t.addEvent("complete",function(e){if(!t.active){return}if(e.getPrevious()){var n=e.get("id").replace(/li_/,"");var r=e.getPrevious().get("id").replace(/li_/,"");var i=window.location.search.replace(/id=[0-9]*/,"id="+n)+"&act=cut&mode=1&page_id="+r;(new Request({url:window.location.href,method:"get",data:i})).send()}else if(e.getParent()){var n=e.get("id").replace(/li_/,"");var r=e.getParent().get("id").replace(/ul_/,"");var i=window.location.search.replace(/id=[0-9]*/,"id="+n)+"&act=cut&mode=2&page_id="+r;(new Request({url:window.location.href,method:"get",data:i})).send()}})}};Isotope.MediaManager={};(function(){"use strict";Isotope.MediaManager.init=function(e,t,n){var r=$("ctrl_"+t);var i=[];var s,o,u,a,f,l;var c={element:document.id(e),request:{endpoint:window.location.href,inputName:t,params:{action:"uploadMediaManager",name:t,REQUEST_TOKEN:Contao.request_token}},failedUploadTextDisplay:{mode:"custom",maxChars:50,responseProperty:"error"},validation:{allowedExtensions:n},callbacks:{onUpload:function(){AjaxRequest.displayBox(Contao.lang.loading+" …")},onComplete:function(e,n,c){if(!c.success){AjaxRequest.hideBox();return}if(c.file){i.push(c.file)}if(this.getInProgress()>0){return}l={};a=r.getElements('[name^="'+t+'"]');for(o=0;o<a.length;o++){s=a[o].get("name").split("[");if(s.length!=3){continue}u=s[1].replace("]","");if(!l[u]){l[u]={}}f=s[2].replace("]","");if(a[o].get("type")=="radio"){if(!l[u][f]){l[u][f]=""}if(a[o].get("checked")){l[u][f]=a[o].get("value")}}else{l[u][f]=a[o].get("value")}}(new Request.Contao({evalScripts:false,onSuccess:function(e,t){r.getElement("div").set("html",t.content);t.javascript&&Browser.exec(t.javascript);AjaxRequest.hideBox();window.fireEvent("ajax_change")}})).post({action:"reloadMediaManager",name:t,value:l,files:i,REQUEST_TOKEN:Contao.request_token});i=[]}}};return new qq.FineUploader(c)};Isotope.MediaManager.makeSortable=function(){$$(".tl_mediamanager .sortable").each(function(e){new Sortables(e,{contstrain:true,opacity:.6,handle:".drag-handle",onComplete:function(){Isotope.MediaManager.resort(e)}})})};Isotope.MediaManager.act=function(e,t,n){var r=document.id(n).getElement("table");var i=r.getFirst("tbody");var s=document.id(e).getParent("tr");var o=i.getChildren();Backend.getScrollOffset();switch(t){case"up":s.getPrevious()?s.injectBefore(s.getPrevious()):s.injectInside(i);break;case"down":s.getNext()?s.injectAfter(s.getNext()):s.injectBefore(i.getFirst());break;case"delete":s.destroy();break}Isotope.MediaManager.resort(i)};Isotope.MediaManager.resort=function(e){var t=e.getChildren(),n,r,i,s,o;for(s=0;s<t.length;s++){r=t[s].getElements("[name]");for(o=0;o<r.length;o++){r[o].name=r[o].name.replace(/\[[0-9]+\]/g,"["+s+"]");r[o].id=r[o].id.replace(/_[0-9]+/g,"_"+s)}i=t[s].getElements("label");for(o=0;o<i.length;o++){i[o].set("for",i[o].get("for").replace(/_[0-9]+/g,"_"+s))}}}})();window.addEvent("domready",function(){Isotope.addInteractiveHelp();Isotope.makeSelectExtendable();Isotope.MediaManager.makeSortable()}).addEvent("structure",function(){Isotope.addInteractiveHelp()});window.addEvent("ajax_change",function(){Isotope.addInteractiveHelp();Isotope.MediaManager.makeSortable()});